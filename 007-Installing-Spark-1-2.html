<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Installing Apache Spark 1.2.0 on HDP 2.2 | Crash Course on Apache Spark</title>

    <!-- Styles and fonts -->
    <link href="themes/glide/stylesheets/glide.css" rel="stylesheet" type="text/css" />
    <link href="themes/glide/stylesheets/syntax.css" rel="stylesheet" type="text/css" />
    <link href='//fonts.googleapis.com/css?family=Bree+Serif&subset=latin,latin-ext' rel='stylesheet' type='text/css'>

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

    <script src="themes/glide/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="x007-Installing-Spark-1-2 glide">
    <div class="page-wrapper">

      <!--[if lt IE 7]>
          <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
      <![endif]-->

      <header class="page-header" role="banner">
<a class="invisilink" href="./">            <span class="book-title">Crash Course on Apache Spark</span>
</a>        <span class="book-author visuallyhidden">by <a href="http://linkedin.com/in/saptak">Saptak Sen</a></span>
      </header>

        <div class="content-wrapper clearfix">

          <section class="main-content" role="main">
            <div class="main-content-source">
              <h1>Installing Apache Spark 1.2.0 on HDP 2.2</h1>

<p>After SSH&#39;ing into your Sandbox, use <code>su</code> to login as root.
Now let&rsquo;s get the bits using the command</p>
<pre class="highlight plaintext">wget http://public-repo-1.hortonworks.com/HDP-LABS/Projects/spark/1.2.0/spark-1.2.0.2.2.0.0-82-bin-2.6.0.2.2.0.0-2041.tgz
</pre>

<p><img src="https://www.dropbox.com/s/a25v1m9mryyxwoh/Screenshot%202015-06-07%2021.52.30.png?dl=1" /></p>

<p>Then uncompress the archive with</p>
<pre class="highlight plaintext">tar xvfz spark-1.2.0.2.2.0.0-82-bin-2.6.0.2.2.0.0-2041.tgz
</pre>

<p><img src="https://www.dropbox.com/s/i3kpjeenqku213n/Screenshot%202015-06-07%2022.03.56.png?dl=1" /></p>

<p>Move the resulting folder to <code>/opt</code> as just <code>spark</code></p>
<pre class="highlight plaintext">mv spark-1.2.0.2.2.0.0-82-bin-2.6.0.2.2.0.0-2041 /opt/spark
</pre>

<p>also for good measure create a symbolic link from <code>/usr/hdp/current/spark-client</code> into <code>/opt/spark</code></p>
<pre class="highlight plaintext">ln -s /opt/spark /usr/hdp/current/spark-client
</pre>

<p><img src="https://www.dropbox.com/s/cpid455mhbrwxmu/Screenshot%202015-06-07%2022.15.28.png?dl=1" /></p>

<p>Create a bash script called spark.sh in the <code>/etc/profile.d</code> with the following lines</p>
<pre class="highlight plaintext">export SPARK_HOME=/usr/hdp/current/spark-client
export YARN_CONF_DIR=/etc/hadoop/conf
export PATH=/usr/hdp/current/spark-client/bin:$PATH
</pre>

<p>Then run the script with</p>
<pre class="highlight plaintext">source /etc/profile.d/spark.sh
</pre>

<p>Create a file <code>SPARK_HOME/conf/spark-defaults.conf</code> and add the following settings:</p>
<pre class="highlight plaintext">spark.driver.extraJavaOptions -Dhdp.version=2.2.0.0–2041
spark.yarn.am.extraJavaOptions -Dhdp.version=2.2.0.0–2041
</pre>

<p>Now before we can test run a sample, use your browser to navigate to <code>http://&lt;hostname&gt;:8080</code> for the Ambari interface. Use <code>admin</code> and <code>admin</code> as username and password respectively to login.</p>

<p><img src="https://www.dropbox.com/s/bw92iidkfhj124r/Screenshot%202015-06-07%2023.12.03.png?dl=1" /></p>

<p>After you login ensure necessary services like Datanode, Nodemanager, ResourceManager, Namenode, HiveServer2, etc are running. If they are stopped, start them and wait for them to start before the next step.</p>

<p><img src="https://www.dropbox.com/s/gnjxv5yjdmdqs65/Screenshot%202015-06-07%2023.15.49.png?dl=1" /></p>

<p>Now we can test the validity of our installation by running the sample Pi calculator</p>
<pre class="highlight plaintext">cd /opt/spark
./bin/spark-submit --verbose --class org.apache.spark.examples.SparkPi --master yarn-cluster --num-executors 3 --driver-memory 512m --executor-memory 512m --executor-cores 1 lib/spark-examples*.jar 10
</pre>

<p><img src="https://www.dropbox.com/s/a6hb26bdd65gc32/Screenshot%202015-06-07%2023.18.31.png?dl=1" /></p>

<p>You can check the value of the result by navigating to the URL above. Make sure you replace <code>sandbox.hortonworks.com</code> with the actual DNS name of your Sandbox VM. Also ensure that you have opened the port 8088 either on Azure or your Virtualization software.</p>

            </div>
            <nav class="main-content-nav clearfix" role="navigation">
              <ul>
                <li><a class="previous" href="004-installing-apache-spark-1-3-1.html">Previous</a></li>
                <li><a class="next" href="010-basics-of-programming-apache-spark.html">Next</a></li>
              </ul>
            </nav>
          </section>

          <aside class="aside-content" role="complementary">
            <div class="aside-wrapper">

              <div class="block table-of-contents">
                <h3>Table of Contents</h3>
                <nav role="navigation">
                  <ul>
                    <li class='child '><a href="./">Introduction</a></li><li class='child '><a href="001-configuring-hortonwork-sandbox-azure.html">Configuring Hortonworks Sandbox on Azure</a></li><li class='child '><a href="004-installing-apache-spark-1-3-1.html">Installing Apache Spark 1.3.1 on HDP 2.2.4.2</a></li><li class='child active'><a href="007-Installing-Spark-1-2.html">Installing Apache Spark 1.2.0 on HDP 2.2</a></li><li class='child '><a href="010-basics-of-programming-apache-spark.html">Basics of programming Apache Spark</a></li><li class='child '><a href="013-scala-primer.html">A short primer on Scala</a></li><li class='child '><a href="016-spark-with-scala.html">Exploring Spark with Scala</a></li><li class='child '><a href="019-hive-orc-spark.html">Using Hive and ORC with Apache Spark</a></li><li class='child '><a href="022-installing-zeppelin.html">Installing and configuring Zeppelin</a></li><li class='child '><a href="025-ipython-notebook-with-apache-spark.html">Using IPython Notebook with Apache Spark</a></li><li class='child '><a href="028-spark-with-hdp.html">A Lap around Apache Spark 1.3.1 with HDP 2.3</a></li>
                  </ul>
                </nav>
              </div>
              <!--
              <div class="block translations">
                <h3>Book translations</h3>
                <p>This book is translated into 
                  <a href="#">Spanish</a>
                  and <a href="#">English</a>.
                  You can help with more translations <a href="https://github.com/saptak/spark">on Github</a>.
                </p>
              </div>
              -->
            </div><!-- end aside-wrapper -->
          </aside>

        </div><!-- end content-wrapper -->

      <footer class="page-footer">

        <div class="footer-wrapper">
          <!--
          <div class="block downloads">&nbsp;
            <h3>Downloads</h3>
            <p>Download this book in
                <a href="#">PDF</a>, <a href="#">mobi</a>, and <a href="#">epub</a>
              form for free.
            </p>
          </div>
          -->
          <div class="block license">
            <h3>License</h3>
            <p>This book is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0">Attribution-ShareAlike</a> license.</p>
          </div>

          <div class="block open-source">
            <h3>This book is open source</h3>
            <p>The source of this book is <a href="https://github.com/saptak/spark">hosted on Github</a>. Go, ahead. Check it out.</p>
          </div>

          <small class="small-text">Made with <a href="http://bitbooks.cc">Bitbooks</a></small>

        </div><!-- end footer-wrapper -->

      </footer>


    </div><!-- end page-wrapper -->

    <!-- include scripts just before the close of the body tag -->
    <script src="themes/glide/javascripts/anchor.min.js" type="text/javascript"></script>
    <script src="themes/glide/javascripts/glide.js" type="text/javascript"></script>
  </body>
</html>