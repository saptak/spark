<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>A short primer on Scala | Crash Course on Apache Spark</title>

    <!-- Styles and fonts -->
    <link href="themes/glide/stylesheets/glide.css" rel="stylesheet" type="text/css" />
    <link href="themes/glide/stylesheets/syntax.css" rel="stylesheet" type="text/css" />
    <link href='//fonts.googleapis.com/css?family=Bree+Serif&subset=latin,latin-ext' rel='stylesheet' type='text/css'>

    <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

    <script src="themes/glide/javascripts/modernizr.js" type="text/javascript"></script>
  </head>

  <body class="x013-scala-primer glide">
    <div class="page-wrapper">

      <!--[if lt IE 7]>
          <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
      <![endif]-->

      <header class="page-header" role="banner">
<a class="invisilink" href="./">            <span class="book-title">Crash Course on Apache Spark</span>
</a>        <span class="book-author visuallyhidden">by <a href="http://linkedin.com/in/saptak">Saptak Sen</a></span>
      </header>

        <div class="content-wrapper clearfix">

          <section class="main-content" role="main">
            <div class="main-content-source">
              <h1>A short primer on Scala</h1>

<p>Scala is relatively new language based on the JVM. The main difference between other “Object Oriented Languages” and Scala is that everything in Scala is an object. The primitive types that are defined in Java, such as int or boolean, are objects in Scala. Functions are treated as objects, too. As objects, they can be passed as arguments, allowing a functional programming approach to writing applications for Apache Spark.</p>

<p>If you have programmed in Java or C#, you should feel right at home with Scala with very little effort.</p>

<p>You can also run or compile Scala programs from commandline or from IDEs such as Eclipse.</p>

<p>To learn and experiment with data, I prefer the interactivity of the Scala shell. Let&rsquo;s launch the Spark shell as it is a fully capable Scala shell.</p>
<pre class="highlight shell">spark-shell --master yarn-client --driver-memory 512m --executor-memory 512m
</pre>

<p><img src="https://www.dropbox.com/s/d21chg1rsetlimq/Screenshot%202015-06-08%2013.20.55.png?dl=1" /></p>

<h3>Values</h3>

<p>Values can be either mutable or immutable. Mutable values are expressed by the <code>var</code> keyword.</p>
<pre class="highlight scala"><span class="k">var</span> <span class="n">a</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">a</span> <span class="k">=</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">println</span><span class="o">(</span><span class="n">a</span><span class="o">)</span>
</pre>

<p><img src="https://www.dropbox.com/s/89ly7aj7yg6ssdb/Screenshot%202015-06-08%2012.26.39.png?dl=1" /></p>

<p>Immutable values are expressed by the <code>val</code> keyword.</p>
<pre class="highlight scala"><span class="k">val</span> <span class="n">b</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">b</span> <span class="k">=</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span> <span class="c1">//Error
</span><span class="n">println</span><span class="o">(</span><span class="n">b</span><span class="o">)</span>
</pre>

<p><img src="https://www.dropbox.com/s/48flcm9q1zlg165/Screenshot%202015-06-08%2012.29.13.png?dl=1" /></p>

<h3>Type Inference</h3>

<p>Scala like Java is a strongly typed language. But, it is very smart in type inference, which alleviates the onus of specifying types from the programmers.</p>
<pre class="highlight scala"><span class="k">var</span> <span class="n">c</span> <span class="k">=</span> <span class="mi">9</span>
<span class="n">println</span><span class="o">(</span><span class="n">c</span><span class="o">.</span><span class="n">getClass</span><span class="o">)</span>

<span class="k">val</span> <span class="n">d</span> <span class="k">=</span> <span class="mf">9.9</span>
<span class="n">println</span><span class="o">(</span><span class="n">d</span><span class="o">.</span><span class="n">getClass</span><span class="o">)</span>

<span class="k">val</span> <span class="n">e</span> <span class="k">=</span> <span class="s">"Hello"</span>
<span class="n">println</span><span class="o">(</span><span class="n">e</span><span class="o">.</span><span class="n">getClass</span><span class="o">)</span>
</pre>

<p><img src="https://www.dropbox.com/s/cdhlibeiu41c1ww/Screenshot%202015-06-08%2012.52.36.png?dl=1" /></p>

<h3>Functions</h3>

<p>Functions are defined with the <code>def</code> keyword. In Scala, the last expression in the function body is returned without the need of the <code>return</code> keyword.</p>
<pre class="highlight scala"><span class="k">def</span> <span class="n">cube</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">x2</span> <span class="k">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
  <span class="n">x2</span>
<span class="o">}</span>

<span class="n">cube</span><span class="o">(</span><span class="mi">3</span><span class="o">)</span>
</pre>

<p><img src="https://www.dropbox.com/s/0w9xcwfe180ylom/Screenshot%202015-06-08%2013.24.04.png?dl=1" /></p>

<p>You can write the function more succinctly by leaving out the braces and the return type as return type can be easily inferred.</p>
<pre class="highlight scala"><span class="k">def</span> <span class="n">cube</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)</span> <span class="k">=</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span>
</pre>

<p><img src="https://www.dropbox.com/s/nh66ybashw7exqf/Screenshot%202015-06-08%2013.27.58.png?dl=1" /></p>

<h3>Anonymous Functions</h3>

<p>Anonymous functions can be assigned as a <code>var</code> or <code>val</code> value. It can also be passed to and returned from other functions.</p>
<pre class="highlight scala"><span class="k">val</span> <span class="n">sqr</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="n">x</span> <span class="k">=&gt;</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">sqr</span><span class="o">(</span><span class="mi">2</span><span class="o">)</span>
</pre>

<p><img src="https://www.dropbox.com/s/00axm7yxhi4tfx0/Screenshot%202015-06-08%2013.50.40.png?dl=1" /></p>

<p>Or, anonymous functions can be further shortened to</p>
<pre class="highlight scala"><span class="k">val</span> <span class="n">thrice</span><span class="k">:</span> <span class="kt">Int</span> <span class="o">=&gt;</span> <span class="nc">Int</span> <span class="k">=</span> <span class="k">_</span> <span class="o">*</span> <span class="mi">3</span>
<span class="n">thrice</span><span class="o">(</span><span class="mi">15</span><span class="o">)</span>
</pre>

<p><img src="https://www.dropbox.com/s/e37sbhm7ie9j2il/Screenshot%202015-06-08%2013.58.41.png?dl=1" /></p>

<p>where <code>_</code> is a the shorthand for whatever the input was.</p>

<h3>Collections</h3>

<p>Scala has very convenient set of collections including Lists, Sets, Tuples, Iterators and Options. When you combine these data structures with anonymous functions and closures it is very expressive.</p>
<pre class="highlight plaintext">val strs = Array("This", "is", "happening")

strs.map(_.reverse)
</pre>

<p><img src="https://www.dropbox.com/s/2b8f3vz68usndmu/Screenshot%202015-06-08%2014.38.48.png?dl=1" /></p>
<pre class="highlight plaintext">strs.reduce(_+" "+_)
</pre>

<p><img src="https://www.dropbox.com/s/vc17p0t06a5wfmy/Screenshot%202015-06-08%2014.28.31.png?dl=1" /></p>

<p>This is far from comprehensive. To learn more visit <a href="http://scala-lang.org">http://scala-lang.org</a></p>

            </div>
            <nav class="main-content-nav clearfix" role="navigation">
              <ul>
                <li><a class="previous" href="010-basics-of-programming-apache-spark.html">Previous</a></li>
                <li><a class="next" href="016-spark-with-scala.html">Next</a></li>
              </ul>
            </nav>
          </section>

          <aside class="aside-content" role="complementary">
            <div class="aside-wrapper">

              <div class="block table-of-contents">
                <h3>Table of Contents</h3>
                <nav role="navigation">
                  <ul>
                    <li class='child '><a href="./">Introduction</a></li><li class='child '><a href="001-configuring-hortonwork-sandbox-azure.html">Configuring Hortonworks Sandbox on Azure</a></li><li class='child '><a href="004-installing-apache-spark-1-3-1.html">Installing Apache Spark 1.3.1 on HDP 2.2.4.2</a></li><li class='child '><a href="007-Installing-Spark-1-2.html">Installing Apache Spark 1.2.0 on HDP 2.2</a></li><li class='child '><a href="010-basics-of-programming-apache-spark.html">Basics of programming Apache Spark</a></li><li class='child active'><a href="013-scala-primer.html">A short primer on Scala</a></li><li class='child '><a href="016-spark-with-scala.html">Exploring Spark with Scala</a></li><li class='child '><a href="019-hive-orc-spark.html">Using Hive and ORC with Apache Spark</a></li><li class='child '><a href="022-installing-zeppelin.html">Installing and configuring Zeppelin</a></li><li class='child '><a href="025-ipython-notebook-with-apache-spark.html">Using IPython Notebook with Apache Spark</a></li><li class='child '><a href="028-spark-with-hdp.html">A Lap around Apache Spark 1.3.1 with HDP 2.3</a></li>
                  </ul>
                </nav>
              </div>
              <!--
              <div class="block translations">
                <h3>Book translations</h3>
                <p>This book is translated into 
                  <a href="#">Spanish</a>
                  and <a href="#">English</a>.
                  You can help with more translations <a href="https://github.com/saptak/spark">on Github</a>.
                </p>
              </div>
              -->
            </div><!-- end aside-wrapper -->
          </aside>

        </div><!-- end content-wrapper -->

      <footer class="page-footer">

        <div class="footer-wrapper">
          <!--
          <div class="block downloads">&nbsp;
            <h3>Downloads</h3>
            <p>Download this book in
                <a href="#">PDF</a>, <a href="#">mobi</a>, and <a href="#">epub</a>
              form for free.
            </p>
          </div>
          -->
          <div class="block license">
            <h3>License</h3>
            <p>This book is licensed under the <a href="https://creativecommons.org/licenses/by-sa/4.0">Attribution-ShareAlike</a> license.</p>
          </div>

          <div class="block open-source">
            <h3>This book is open source</h3>
            <p>The source of this book is <a href="https://github.com/saptak/spark">hosted on Github</a>. Go, ahead. Check it out.</p>
          </div>

          <small class="small-text">Made with <a href="http://bitbooks.cc">Bitbooks</a></small>

        </div><!-- end footer-wrapper -->

      </footer>


    </div><!-- end page-wrapper -->

    <!-- include scripts just before the close of the body tag -->
    <script src="themes/glide/javascripts/anchor.min.js" type="text/javascript"></script>
    <script src="themes/glide/javascripts/glide.js" type="text/javascript"></script>
  </body>
</html>